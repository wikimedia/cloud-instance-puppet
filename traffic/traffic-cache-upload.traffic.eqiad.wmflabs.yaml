admin::groups:
- perf-roots
- varnish-log-readers
cache::cluster: upload
cache::lua_support: true
cache::req_handling:
  maps.wikimedia.org:
    director: kartotherian
  upload.wikimedia.org:
    director: swift
    subpaths:
      ^/+[^/]+/[^/]+/thumb/:
        director: swift_thumbs
cache::ssl_dyn_rec: true
cache::tune_for_media: true
cluster: cache_upload
mtail::service_ensure: absent
profile::cache::base::admission_policy: none
profile::cache::base::default_weights:
  ats-be: 100
  nginx: 1
  varnish-fe: 1
profile::cache::base::extra_nets:
- 172.16.0.0/12
profile::cache::base::fe_runtime_params:
- default_ttl=86400
profile::cache::base::purge_host_regex: '[um][pa][lp][os]'
profile::cache::base::purge_multicasts:
- 239.128.0.112
- 239.128.0.113
- 239.128.0.114
- 239.128.0.115
profile::cache::base::purge_varnishes:
- 127.0.0.1:3128
- 127.0.0.1:3127,1.0
profile::cache::kafka::webrequest::kafka_cluster_name: jumbo-eqiad
profile::cache::kafka::webrequest::monitoring_enabled: true
profile::cache::kafka::webrequest::ssl_enabled: true
profile::cache::ssl::unified::acme_chief: true
profile::cache::ssl::unified::letsencrypt: false
profile::cache::ssl::unified::monitoring: true
profile::cache::ssl::unified::tls_port: 4443
profile::cache::ssl::unified::use_trafficserver_tls: true
profile::cache::upload::upload_webp_hits_threshold: 100
profile::cache::varnish::cache_be_opts:
  between_bytes_timeout: 60s
  connect_timeout: 5s
  first_byte_timeout: 35s
  max_connections: 50000
  port: 3128
  probe: varnish
profile::cache::varnish::common_vcl_config:
  allowed_methods: ^(GET|HEAD|OPTIONS|PURGE)$
  maps_domain: maps.wikimedia.org
  purge_host_regex: ^(upload|maps)\.wikimedia\.org$
  upload_domain: upload.wikimedia.org
  upload_webp_hits_threshold: 100
profile::cache::varnish::frontend::backend_services:
- ats-be
profile::cache::varnish::frontend::fe_extra_vcl:
- upload-common
- normalize_path
profile::cache::varnish::frontend::fe_jemalloc_conf: lg_dirty_mult:8,lg_chunk:17
profile::cache::varnish::frontend::fe_vcl_config:
  admission_policy: none
  keep: 1d
  pass_random: false
  varnish_probe_ms: 100
profile::trafficserver::tls::port: 443
prometheus::node_exporter::collectors_extra:
- qdisc
- meminfo_numa
prometheus::varnishkafka_exporter::config:
  num_entries_to_get: 2
  required_entries:
  - kafka
  - varnishkafka
  stats_files:
  - /var/cache/varnishkafka/webrequest.stats.json
