profile::docker::engine::declare_service: true
profile::docker::engine::packagename: docker.io
profile::docker::engine::settings: {}
profile::docker::engine::version: 20.10.5+dfsg1-1
profile::docker::runner::service_defs:
  mediawiki-services-function-evaluator:
    config:
      logging:
        level: trace
        streams:
        - named_levels: true
          type: stdout
      metrics:
        host: cloudmetrics1002.eqiad.wmnet
        name: function-evaluator
        port: 8125
        type: statsd
      num_workers: 3
      services:
      - conf:
          cors: '*'
          mwapi_req:
            body: '{{ default(request.query, {}) }}'
            headers:
              user-agent: '{{user-agent}}'
            method: post
            uri: https://{{domain}}/w/api.php
          port: 6927
          restbase_req:
            body: '{{request.body}}'
            headers: '{{request.headers}}'
            method: '{{request.method}}'
            query: '{{ default(request.query, {}) }}'
            uri: https://{{domain}}/api/rest_v1/{+path}
          spec: ./spec.template.yaml
        module: ./app.js
        name: function-evaluator
      worker_heap_limit_mb: 250
    namespace: wikimedia
    override_cmd: -c /etc/mediawiki-services-function-evaluator/config.yaml
    port: 6927
    version: latest
  mediawiki-services-function-orchestrator:
    config:
      logging:
        level: trace
        streams:
        - named_levels: true
          type: stdout
      metrics:
        host: cloudmetrics1002.eqiad.wmnet
        name: function-orchestrator
        port: 8125
        type: statsd
      num_workers: 3
      services:
      - conf:
          cors: '*'
          mwapi_req:
            body: '{{ default(request.query, {}) }}'
            headers:
              user-agent: '{{user-agent}}'
            method: post
            uri: https://{{domain}}/w/api.php
          port: 6254
          restbase_req:
            body: '{{request.body}}'
            headers: '{{request.headers}}'
            method: '{{request.method}}'
            query: '{{ default(request.query, {}) }}'
            uri: https://{{domain}}/api/rest_v1/{+path}
          spec: ./spec.yaml
        module: ./app.js
        name: function-orchestrator
      worker_heap_limit_mb: 250
    environment:
      FUNCTION_EVALUATOR_URL: https://wikifunctions-evaluator-beta.wmflabs.org/1/v1/evaluate/
      NODE_TLS_REJECT_UNAUTHORIZED: '0'
      WIKI_API_URL: https://wikifunctions.beta.wmflabs.org/w/api.php
    namespace: wikimedia
    override_cmd: -c /etc/mediawiki-services-function-orchestrator/config.yaml
    port: 6254
    version: latest
profile::docker::storage::physical_volumes: /dev/md1
profile::docker::storage::vg_to_remove: todelete
puppetmaster: deployment-puppetmaster04.deployment-prep.eqiad.wmflabs
